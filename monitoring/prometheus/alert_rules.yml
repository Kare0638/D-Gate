groups:
  - name: dgate_alerts
    rules:
      - alert: HighInferenceLatency
        expr: histogram_quantile(0.95, rate(dgate_inference_duration_seconds_bucket[5m])) > 10
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High p95 inference latency"
          description: "p95 inference latency is above 10s for 2 minutes"

      - alert: HighErrorRate
        expr: rate(dgate_requests_total{status="error"}[5m]) / rate(dgate_requests_total[5m]) > 0.05
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "High error rate"
          description: "Error rate exceeds 5% for 1 minute"

      - alert: HighVRAMUsage
        expr: dgate_vram_usage_bytes / dgate_vram_total_bytes > 0.95
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "VRAM usage above 95%"
